<!-- Banner -->

<div class="banner d-flex flex-column justify-content-between"

style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)),
                          <% if @campaign.photo.attached? %>
                            url('<%= cl_image_path @campaign.photo.key, height: 500, crop: :fill %>')"
                          <% else %>
                            url('https://images.unsplash.com/photo-1536939459926-301728717817?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1350&q=80')"
                          <% end %>>
  <div class="container">
    <!-- add if statement depending on sorter or recycler -->
    <h4><%= link_to :back, class: "position-absolute" do %>
      <i class="fas fa-arrow-left"></i>
      <% end %>
    </h4>
  </div>

  <div class="container">
    <div class="d-flex flex-column align-items-center">
      <% if @campaign.organisation.photo.attached? %>
        <%= cl_image_tag @campaign.organisation.photo.key, class: "avatar-large mb-2 plastroc-light-shadow"%>
      <% else %>
        <img src="https://images.unsplash.com/photo-1536939459926-301728717817?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1350&q=80" alt="">
      <% end %>
      <h5 class="mb-0"><%= @campaign.name %></h5>
      <h6>by <%= @campaign.organisation.name %></h6>
    </div>
  </div>
</div>

<!-- Tabs -->

<nav class="nav plastroc-tabs d-flex justify-content-around flex-nowrap py-3">
  <a class="active" href="#tab-dashboard" data-toggle="tab">Tableau de bord</a>
  <a class="" href="#tab-mission-details" data-toggle="tab">Ma campagne</a>
  <a class="" href="#tab-about-me" data-toggle="tab">Mes infos</a>
</nav>

<!-- Tabs-content -->

<div class="tab-content position-relative" style="margin-bottom: 75px;">

  <!-- Dashboard-Tab -->

  <div class="tab-pane active" id="tab-dashboard">
    <div class="container">
      <h5 class="mt-2">Progression</h5>
      <div class="container">
        <div class="d-flex justify-content-between align-items-center">
            <h6 class="mb-0">Complété</h6>
            <p class="mb-0"><%= @volume_done %>/<%= @campaign.target %><%= @campaign.unit %></p>
        </div>
        <!-- cf new show for dynamic progress bar -->
        <div class="plastroc-progress-bar mt-2 mb-4">
          <div class="rounded-pill plastroc-bg-primary-gradient"></div>
        </div>

        <div class="d-flex justify-content-between align-items-center">
            <h6 class="mb-0">Engagé</h6>
            <p class="mb-0"><%= @volume_total %>/<%= @campaign.target %><%= @campaign.unit %></p>
        </div>
        <!-- cf new show for dynamic progress bar -->
        <div class="plastroc-progress-bar mt-2 mb-4">
          <div class="rounded-pill plastroc-bg-primary-gradient"></div>
        </div>
      </div>

      <h5>Questions</h5>
      <div class="container">
        <h6>De Laura 27/07/2020</h6>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip.</p>
        <div class="container">
         <h6>John a répondu le 28/07/2020</h6>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Mission-details-Tab -->

  <div class="tab-pane" id="tab-mission-details">
    <div class="container">

      <%= render 'shared/info_content' %>

      <h5>Tuto</h5>

      <%= render 'shared/how_to_content' %>

    </div>
  </div>

  <!-- About-me-Tab -->

  <div class="tab-pane" id="tab-about-me">
    <div class="container">

      <%= render 'shared/contact_content' %>

    <% if current_user != @campaign.user %>
      <button href="#" class='btn btn-outline-primary rounded-pill d-block mt-3 plastroc-outline-button w-100'>
        Poser une question
      </button>
    <% end %>

    </div>
  </div>

<!-- Edit & stop buttons -->

  <div class="bottom-nav">
      <div class="d-flex justify-content-around">
          <p><a href="#" style="color: &plastroc-main;" data-toggle="modal" data-target="#editModal">Editer</a></p>
          <p><a href="#" style="color: red;">Stopper</a></p>
      </div>
  </div>

</div>

<!-- Modal Edit  -->

<div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Editer la campagne</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="container" style="margin-bottom: 75px;">
          <div id="materials" data-materials="<%= @materials.to_json %>"></div>
          <%= simple_form_for @campaign do |f| %>
            <%= f.input :name,
                        label: "Nom",
                        placeholder: "Nom*",
                        input_html: { class: "col-12 mb-3" } %>

            <%= f.input :description,
                        label: "Description",
                        placeholder: "Description*",
                        input_html: { class: "col-12 mb-3" } %>

            <%= f.input :end_date,
                        as: :string,
                        required: false,
                        input_html: { class: "date-picker col-12 mb-3" } %>

            <%= f.input :target,
                        label: "Quantité totale",
                        placeholder: "Quantité totale*",
                        input_html: { class: "input col-12 mb-3" } %>

            <%= f.input :min_package,
                        label: "Quantité minimum par mission",
                        placeholder: "Quantité minimum par mission*",
                        input_html: { class: "col-12 mb-3" } %>

            <%= f.input :unit,
                        label: false,
                        as: :radio_buttons,
                        collection: Campaign::UNITS,
                        boolean_style: :inline,
                        collection_wrapper_tag: 'div',
                        collection_wrapper_class: 'unit-wrapper',
                        item_wrapper_class: 'unit-item',
                        input_html: {class: 'unit-selector'} %>

            <%= f.input :min_package,
                        label: "Quantité minimum par mission",
                        placeholder: "Quantité minimum par mission*",
                        input_html: { class: "col-12 mb-3" } %>

            <%= f.input :photo,
                        as: :file,
                        input_html: { class: "input col-12 mb-3" } %>

            <%= f.submit 'Valider', class: "btn btn-primary rounded-pill d-block plastroc-button plastroc-light-shadow col-12 mb-3" %>
          <% end %>
          <%= link_to 'Annuler', dashboard_campaign_path(@campaign), class: "btn btn-outline-primary rounded-pill d-block mt-3 plastroc-outline-button" %>
        </div>
      </div>
    </div>
  </div>
</div>

